{
  "template_info": {
    "name": "Laporan_Kinerja_FFB",
    "description": "Laporan Kinerja Fresh Fruit Bunch (FFB) Scanner Data",
    "version": "1.0",
    "author": "System Administrator",
    "created_date": "2025-01-01",
    "excel_file": "laporan_kinerja_template.xlsx"
  },
  "data_sources": {
    "database_type": "firebird",
    "tables": [
      "FFBSCANNERDATA09",
      "FFBSCANNERDATA10", 
      "FFBSCANNERDATA11",
      "FFBSCANNERDATA12",
      "EMP",
      "OCFIELD",
      "CRDIVISION"
    ]
  },
  "queries": [
    {
      "name": "employee_mapping",
      "description": "Get employee information and mapping",
      "sql": "SELECT EMPID, EMPNAME, DIVISIONID FROM EMP WHERE DIVISIONID IS NOT NULL",
      "parameters": [],
      "output_format": "table",
      "transformations": []
    },
    {
      "name": "divisions",
      "description": "Get division information",
      "sql": "SELECT DIVISIONID, DIVISIONNAME FROM CRDIVISION ORDER BY DIVISIONNAME",
      "parameters": [],
      "output_format": "table",
      "transformations": []
    },
    {
      "name": "transaction_data",
      "description": "Get all transaction data for the period",
      "sql": "SELECT TRANSNO, EMPID, TRANSDATE, TRANSTIME, ESTATE, AFDELING, BLOK, TPHNO, JJGMATANG, JJGMENTAH, JJGOVERIPE, JJGABNORMAL, JJGEMPTY, JJGLEWATMATANG, BRTKOTOR, BRTBERSIH, POTONGAN FROM FFBSCANNERDATA10 WHERE TRANSDATE BETWEEN '2024-10-01' AND '2024-10-31'",
      "parameters": [],
      "output_format": "table",
      "transformations": [
        {
          "type": "date_format",
          "field": "TRANSDATE",
          "format": "DD/MM/YYYY"
        }
      ]
    },
    {
      "name": "kerani_data",
      "description": "Get kerani (PM) transaction data",
      "sql": "SELECT TRANSNO, EMPID, TRANSDATE, TRANSTIME, ESTATE, AFDELING, BLOK, TPHNO, JJGMATANG, JJGMENTAH, JJGOVERIPE, JJGABNORMAL, JJGEMPTY, JJGLEWATMATANG, BRTKOTOR, BRTBERSIH, POTONGAN FROM FFBSCANNERDATA10 WHERE TRANSTYPE = 'PM' AND TRANSDATE BETWEEN '2024-10-01' AND '2024-10-31'",
      "parameters": [],
      "output_format": "table",
      "transformations": []
    },
    {
      "name": "mandor_data", 
      "description": "Get mandor (P1) transaction data",
      "sql": "SELECT TRANSNO, EMPID, TRANSDATE, TRANSTIME, ESTATE, AFDELING, BLOK, TPHNO, JJGMATANG, JJGMENTAH, JJGOVERIPE, JJGABNORMAL, JJGEMPTY, JJGLEWATMATANG, BRTKOTOR, BRTBERSIH, POTONGAN FROM FFBSCANNERDATA10 WHERE TRANSTYPE = 'P1' AND TRANSDATE BETWEEN '2024-10-01' AND '2024-10-31'",
      "parameters": [],
      "output_format": "table",
      "transformations": []
    },
    {
      "name": "asisten_data",
      "description": "Get asisten (P5) transaction data", 
      "sql": "SELECT TRANSNO, EMPID, TRANSDATE, TRANSTIME, ESTATE, AFDELING, BLOK, TPHNO, JJGMATANG, JJGMENTAH, JJGOVERIPE, JJGABNORMAL, JJGEMPTY, JJGLEWATMATANG, BRTKOTOR, BRTBERSIH, POTONGAN FROM FFBSCANNERDATA10 WHERE TRANSTYPE = 'P5' AND TRANSDATE BETWEEN '2024-10-01' AND '2024-10-31'",
      "parameters": [],
      "output_format": "table",
      "transformations": []
    }
  ],
  "mappings": {
    "REPORT_DATE": "current_date",
    "REPORT_TIME": "current_time", 
    "GENERATED_TIMESTAMP": "current_timestamp",
    "EMPLOYEE_DATA": "employee_mapping",
    "DIVISION_DATA": "divisions",
    "TRANSACTION_DATA": "transaction_data",
    "KERANI_DATA": "kerani_data",
    "MANDOR_DATA": "mandor_data",
    "ASISTEN_DATA": "asisten_data",
    "ESTATE_NAME": "estate_name",
    "DIVISION_NAME": "division_name",
    "EMPLOYEE_NAME": "employee_name",
    "ROLE_TYPE": "role_type",
    "TRANSACTION_COUNT": "transaction_count",
    "VERIFICATION_PERCENTAGE": "verification_percentage",
    "DIFFERENCE_DESCRIPTION": "difference_description",
    "PERIOD_TEXT": "period_text"
  },
  "parameters": {
    "start_date": {
      "type": "date",
      "required": true,
      "description": "Tanggal mulai periode laporan (YYYY-MM-DD)"
    },
    "end_date": {
      "type": "date", 
      "required": true,
      "description": "Tanggal akhir periode laporan (YYYY-MM-DD)"
    },
    "month": {
      "type": "integer",
      "required": true,
      "description": "Bulan untuk tabel FFBSCANNERDATA (1-12)"
    },
    "division_id": {
      "type": "string",
      "required": false,
      "description": "ID divisi untuk filter (opsional, jika kosong akan memproses semua divisi)"
    }
  },
  "output_structure": {
    "headers": {
      "A1": "ESTATE",
      "B1": "DIVISI", 
      "C1": "KARYAWAN",
      "D1": "ROLE",
      "E1": "JUMLAH TRANSAKSI",
      "F1": "PERSENTASE TERVERIFIKASI",
      "G1": "KETERANGAN PERBEDAAN",
      "H1": "PERIODE LAPORAN"
    },
    "data_start_row": 2,
    "columns": {
      "A": "estate_name",
      "B": "division_name", 
      "C": "employee_name",
      "D": "role_type",
      "E": "transaction_count",
      "F": "verification_percentage",
      "G": "difference_description",
      "H": "period_text"
    }
  },
  "calculations": {
    "verification_percentage": {
      "formula": "(verified_transactions / total_transactions) * 100",
      "description": "Persentase transaksi yang terverifikasi"
    },
    "difference_detection": {
      "description": "Deteksi perbedaan antara input kerani dan mandor/asisten",
      "logic": "Compare field values between PM and P1/P5 records for same TRANSNO"
    }
  },
  "styling": {
    "header_style": {
      "background_color": "#2C5282",
      "text_color": "white",
      "font": "Helvetica-Bold",
      "font_size": 10
    },
    "kerani_style": {
      "background_color": "#FFF5F5"
    },
    "mandor_style": {
      "background_color": "#F0FFF4"
    },
    "asisten_style": {
      "background_color": "#F0F9FF"
    },
    "summary_style": {
      "background_color": "#4299E1",
      "text_color": "white",
      "font": "Helvetica-Bold"
    }
  },
  "transformations": [
    {
      "type": "string_format",
      "format_type": "upper",
      "columns": ["ESTATE", "EMPNAME"]
    }
  ],
  "formatting": {
    "auto_width": true,
    "borders": true,
    "header_style": {
      "font": {
        "bold": true,
        "size": 12
      },
      "fill": {
        "color": "CCCCCC"
      }
    }
  },
  "validation_rules": [
    {
      "type": "required_placeholders",
      "placeholders": ["{{REPORT_DATE}}", "{{TRANSACTION_DATA}}"]
    },
    {
      "type": "data_consistency",
      "checks": ["non_empty_results", "valid_date_range"]
    }
  ]
}